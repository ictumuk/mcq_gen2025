<!-- History Panel: dynamic list (max 3 items) -->
<div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 overflow-hidden">
  <div class="border-b border-gray-100 dark:border-gray-700 p-4 flex items-center justify-between">
    <h2 class="text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2">
      <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
      </svg>
      Lịch Sử
    </h2>
    <a href="{% url 'dashboard' %}" class="text-sm text-blue-600 hover:text-blue-700 font-medium">Xem tất cả</a>
  </div>

  {% if subjects %}
  <div class="p-4 space-y-3">
    {% for item in subjects|slice:":3" %}
    <div class="history-item flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer transition-colors" 
         data-subject-id="{{ item.id }}" 
         onclick="loadSubjectQuestions('{{ item.id }}')">
      <div class="w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0">
        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-medium text-gray-900 dark:text-white truncate">{{ item.title|default:"Không có tiêu đề" }}</p>
        <div class="flex items-center gap-3 mt-1 text-sm text-gray-500 dark:text-gray-400">
          <span class="flex items-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            {{ item.questions.count }} câu hỏi
          </span>
          <span>•</span>
          <span>{{ item.difficulty|capfirst }}</span>
          <span>•</span>
          <span>{{ item.updated_at|timesince }} trước</span>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="px-6 py-16 text-center">
    <p class="text-sm text-gray-500">Chưa có lịch sử gần đây</p>
  </div>
  {% endif %}
</div>